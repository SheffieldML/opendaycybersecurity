<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>[Challenge 3] Email System</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2245%22 stroke=%22%237000ff%22 stroke-width=%225%22 fill=%22none%22/><path d=%22M50 20 L85 45 L70 80 L30 80 L15 45 Z%22 fill=%22%23c6bbff%22/></svg>">

    <style>
      :root {
        --shef-brand: #440099;
        --shef-bg: #24125e;
        --shef-cta: #7000ff;
        --shef-soft-1: #a78cfa;
        --shef-soft-2: #c6bbff;
        --shef-blue: #005a8f;
        --shef-teal: #00bbcc;
        --shef-teal-soft: #9adbe8;
        --text-on-dark: #f5f3ff;
        --text-on-light: #201540;
        --error: #ff79e1;
      }
      html, body { margin: 0; padding: 0; }
      body {
        min-height: 100vh; background-color: var(--shef-bg);
        color: var(--text-on-dark);
        font-family: system-ui, sans-serif; font-size: 16px; line-height: 1.5;
        display: flex; flex-direction: column;
      }

      /* HEADER */
      header.main-header {
        background-color: rgba(0, 0, 0, 0.2); border-bottom: 1px solid var(--shef-brand);
        padding: 1rem 0; margin-bottom: 2rem;
      }
      .header-content {
        max-width: 46rem; /* Standard Width */
        margin: 0 auto; padding: 0 1.5rem;
        display: flex; align-items: center; gap: 15px;
      }
      .logo-icon { width: 50px; height: 50px; }
      .brand-name { display: flex; flex-direction: column; line-height: 1.1; }
      .brand-title { font-weight: 700; font-size: 1.4rem; color: #fff; letter-spacing: 0.03em; }
      .brand-subtitle { font-size: 0.85rem; color: var(--shef-soft-1); text-transform: uppercase; letter-spacing: 0.1em; }

      .container {
        max-width: 46rem; /* Standard Width */
        margin-left: auto; margin-right: auto;
        padding: 0 1.5rem 2rem 1.5rem;
        flex: 1; width: 100%; box-sizing: border-box;
      }

      h1 {
        margin-top: 0; margin-bottom: 1rem; padding-bottom: 0.35rem;
        border-bottom: 3px solid var(--shef-soft-1); font-size: 1.6rem;
      }
      p { margin-top: 0; margin-bottom: 0.75rem; }

      /* Inbox specific styles */
      #receivedemails {
        display: block; padding: 0.75rem;
        min-height: 4rem; max-height: 14rem; overflow-y: auto;
        background-color: rgba(20, 7, 56, 0.8);
        border-radius: 0.75rem; border: 1px solid rgba(198, 187, 255, 0.7);
        margin-bottom: 2rem;
      }
      #receivedemails b { color: var(--shef-teal-soft); display: block; margin-top: 0.5rem; }

      input[type="text"], textarea {
        width: 100%; box-sizing: border-box; margin-top: 0.25rem; margin-bottom: 0.7rem;
        padding: 0.4rem 0.6rem; border-radius: 0.25rem; border: 1px solid var(--shef-soft-2);
        background-color: #f8f6ff; color: var(--text-on-light); font: inherit;
      }
      input:focus, textarea:focus { outline: 2px solid var(--shef-cta); background-color: #fff; }
      
      a.button-like {
        display: inline-flex; align-items: center; justify-content: center;
        padding: 0.35rem 0.9rem; border-radius: 999px; border: 2px solid var(--shef-cta);
        background-color: transparent; color: var(--text-on-dark); font-weight: 600;
        text-decoration: none; min-width: 4.5rem; cursor: pointer;
      }
      a.button-like:hover { background-color: var(--shef-cta); color: #fff; }

      /* Footer */
      .main-footer {
        background-color: rgba(0, 0, 0, 0.3); border-top: 1px solid var(--shef-brand);
        padding: 1rem 0; margin-top: 3rem; font-size: 0.85rem; color: var(--shef-soft-1);
      }
      .footer-content {
        max-width: 46rem; /* Standard Width */
        margin: 0 auto; padding: 0 1.5rem;
        display: flex; justify-content: space-between; align-items: center;
      }
      .footer-left strong { color: #fff; }
      .separator { margin: 0 0.5rem; opacity: 0.5; }
      .footer-right {
        display: flex; align-items: center; gap: 8px;
        background: rgba(0,0,0,0.2); padding: 4px 10px;
        border-radius: 99px; border: 1px solid var(--shef-brand);
      }
      .status-indicator {
        width: 8px; height: 8px; background-color: #00ff88;
        border-radius: 50%; box-shadow: 0 0 8px #00ff88;
      }
      .status-text { font-weight: 600; color: #ccffdd; }

      @media (max-width: 600px) {
        .header-content { flex-direction: row; } 
        .footer-content { flex-direction: column; gap: 1rem; text-align: center; }
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>
  <body>
    <header class="main-header">
      <div class="header-content">
        <svg class="logo-icon" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
           <circle cx="50" cy="50" r="45" stroke="#7000ff" stroke-width="5" fill="none"/>
           <path d="M50 20 L85 45 L70 80 L30 80 L15 45 Z" fill="#c6bbff" stroke="#440099" stroke-width="3" stroke-linejoin="round"/>
           <path d="M15 45 L30 80 M85 45 L70 80 M15 45 L50 50 M85 45 L50 50 M30 80 L50 50 M70 80 L50 50 M15 45 L50 20 M85 45 L50 20" stroke="#440099" stroke-width="1.5" stroke-opacity="0.6"/>
        </svg>
        <div class="brand-name">
          <span class="brand-title">Diamond Forge</span>
          <span class="brand-subtitle">Sheffield</span>
        </div>
      </div>
    </header>

    <div class="container">
      <h1>[Challenge 3] Email System</h1>
      <p><b>Inbox [<span id="num">0</span> emails]</b></p>
      <div id="receivedemails"></div>

      <p><b>Write Email to: Emma</b></p>
      <form id="email-form">
        Subject: <br>
        <input type="text" label="subject" id="subject" name="subject" aria-label="Email subject"><br />
        Message: <br>
        <textarea label="message" id="message" name="message" rows="10" aria-label="Email message body"></textarea>
        <br>
        <a href="#" id="send" class="button-like" role="button" aria-label="Send email to Emma">send</a>
        <span id="sentmsg" style="margin-left: 10px; color: var(--shef-teal-soft);">Sent!</span>
      </form>
    </div>

    <footer class="main-footer">
      <div class="footer-content">
        <div class="footer-left">
          <span>&copy; 2026 <strong>Diamond Forge</strong></span>
          <span class="separator">|</span>
          <span>Sheffield</span>
        </div>
        <div class="footer-right">
          <span>System Status:</span>
          <span class="status-indicator"></span>
          <span class="status-text">Online</span>
        </div>
      </div>
    </footer>

    <script type="text/javascript">
        $('span#sentmsg').hide();
        var num_emails = 0;
        $('#send').on('click',function(e){
            e.preventDefault();
            var url = 'http://{{server}}/sendemail?subject='+encodeURIComponent($('input#subject').val())+"&message="+encodeURIComponent($('textarea#message').val());
            $.getJSON(url, function(data) {
                console.log("Sent Email");
                $('input#subject').val("");
                $('textarea#message').val("");
                $('span#sentmsg').show();
                $('span#sentmsg').fadeOut(3000);
            });
        });

        setInterval(function () {
            var url = "http://{{server}}/checkemail";
            $.ajax({
                url: url,
                success: function (data) {
                    for (var i=0;i<data.length;i++) {
                        var d=data[i];
                        $('div#receivedemails').append("<b>From: Emma &bull; Subject: "+d['sub']+ "</b>"+d['msg']+"<br/>");
                        num_emails = num_emails + 1;
                        $('span#num').text(num_emails);
                    }
                }
            });
        }, 2000);
    </script>
  </body>
</html>
